
[TOC]

# 好友相關邏輯

### 好友申請流程

1. **用戶發起好友申請：** 用戶A想要添加用戶B為好友，因此A發送好友請求給B。
2. **服務器接收好友請求：** 服務器接收到用戶A發送的好友請求，請求中包括了A和B的用戶ID。
3. **驗證是否已發送好友請求：** 服務器首先檢查數據庫，以確保A尚未向B發送過好友請求。如果已經發送過，則返回相應的錯誤消息（例如，RequestFrequentOperationError）。
4. **驗證是否已經是好友：** 接下來，服務器檢查數據庫以確保A和B不是已經是好友。如果已經是好友，則返回相應的錯誤消息（例如，已存在的好友關系）。
5. **創建好友請求：** 如果A尚未向B發送好友請求並且A和B不是已經是好友，服務器將創建一個新的好友請求，並將其保存到數據庫中。請求的狀態將設置為 "pending"。
6. **發送通知給用戶B：** 服務器可以向用戶B發送通知，告知他們有一個新的好友請求等待他們的回應。
7. **用戶B接受或拒絕好友請求：** 用戶B可以查看他們的好友請求通知，並選擇接受或拒絕請求。
8. **服務器更新好友請求狀態：** 如果用戶B接受了好友請求，服務器將更新好友請求的狀態為 "accepted"。如果用戶B拒絕了好友請求，服務器將更新請求的狀態為 "rejected"。
9. **創建好友關系：** 如果用戶B接受了好友請求，服務器將創建一個新的好友關系，並將其保存到數據庫中，以表示A和B現在是好友。
10. **通知用戶A：** 服務器可以向用戶A發送通知，告知他們用戶B已經接受了好友請求，或者通知他們用戶B拒絕了請求。


### 

接受或拒绝来自特定用户ID的好友请求的API流程：

1. **用戶接受或拒絕好友請求：** 用戶B接收到好友請求通知後，可以選擇接受或拒絕請求。
2. **用戶發起API請求：** 用戶B在接受或拒絕請求時，通過調用API來執行此操作。API的端點為 `/friend-requests`，請求類型為 `PUT`。
3. **API接收請求：** 服務器接收到用戶B的API請求，該請求應包含來自特定用戶ID的好友請求的相關信息，如請求ID、接受或拒絕的狀態等。
4. **驗證好友請求的存在：** 服務器首先驗證指定ID的好友請求是否存在，以確保用戶B正在處理有效的請求。如果請求不存在，服務器將返回適當的錯誤響應。
5. **處理好友請求狀態：** 服務器根據用戶B的操作，將好友請求的狀態更新為 "accepted"（接受）或 "rejected"（拒絕）。
6. **通知用戶A：** 如果用戶B接受了好友請求，服務器可以向用戶A發送通知，告知他們用戶B已經接受了好友請求。如果用戶B拒絕了好友請求，服務器可以向用戶A發送通知，告知他們用戶B拒絕了請求。
7. **更新好友關系：** 如果用戶B接受了好友請求，服務器還將創建一個新的好友關系，並將其保存到數據庫中，以表示A和B現在是好友。
8. **返回響應：** 服務器將根據操作的結果返回適當的響應。如果操作成功，服務器將返回成功響應（例如，HTTP 200）。如果發生錯誤（例如，請求不存在），服務器將返回相應的錯誤響應（例如，HTTP 404 或 HTTP 409）。
