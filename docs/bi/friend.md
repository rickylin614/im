
[TOC]

# 好友相關邏輯

### 好友申請流程

1. **用户发起好友申请：** 用户A想要添加用户B为好友，因此A发送好友请求给B。
2. **服务器接收好友请求：** 服务器接收到用户A发送的好友请求，请求中包括了A和B的用户ID。
3. **验证是否已发送好友请求：** 服务器首先检查数据库，以确保A尚未向B发送过好友请求。如果已经发送过，则返回相应的错误消息（例如，RequestFrequentOperationError）。
4. **验证是否已经是好友：** 接下来，服务器检查数据库以确保A和B不是已经是好友。如果已经是好友，则返回相应的错误消息（例如，已存在的好友关系）。
5. **创建好友请求：** 如果A尚未向B发送好友请求并且A和B不是已经是好友，服务器将创建一个新的好友请求，并将其保存到数据库中。请求的状态将设置为 "pending"。
6. **发送通知给用户B：** 服务器可以向用户B发送通知，告知他们有一个新的好友请求等待他们的回应。
7. **用户B接受或拒绝好友请求：** 用户B可以查看他们的好友请求通知，并选择接受或拒绝请求。
8. **服务器更新好友请求状态：** 如果用户B接受了好友请求，服务器将更新好友请求的状态为 "accepted"。如果用户B拒绝了好友请求，服务器将更新请求的状态为 "rejected"。
9. **创建好友关系：** 如果用户B接受了好友请求，服务器将创建一个新的好友关系，并将其保存到数据库中，以表示A和B现在是好友。
10. **通知用户A：** 服务器可以向用户A发送通知，告知他们用户B已经接受了好友请求，或者通知他们用户B拒绝了请求。


### 